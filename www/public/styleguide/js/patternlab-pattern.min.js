function receiveIframeMessage(t){if("file:"==window.location.protocol||t.origin===window.location.protocol+"//"+window.location.host){var e,n="string"!=typeof t.data?t.data:JSON.parse(t.data);if("patternLab.updatePath"==n.event)if(void 0!==patternData.patternPartial){var a=/(patterns|snapshots)\/(.*)$/;e=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(a,"")+n.path+"?"+Date.now(),window.location.replace(e)}else e=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("styleguide/html/styleguide.html","")+n.path+"?"+Date.now(),window.location.replace(e);else"patternLab.reload"==n.event&&window.location.reload()}}if(self!=top){var path=window.location.toString(),parts=path.split("?"),options={event:"patternLab.pageLoad",path:parts[0]};options.patternpartial=void 0!==patternData.patternPartial?patternData.patternPartial:"all",""!==patternData.lineage&&(options.lineage=patternData.lineage);var targetOrigin="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(options,targetOrigin);for(var aTags=document.getElementsByTagName("a"),i=0;i<aTags.length;i++)aTags[i].onclick=function(t){var e=this.getAttribute("href"),n=this.getAttribute("target");if(void 0===n||"_parent"!=n&&"_blank"!=n){if(!e||"#"===e)return t.preventDefault(),!1;t.preventDefault(),window.location.replace(e)}else;};for(var keys=["s","m","l","d","h","f"],i=0;i<keys.length;i++)jwerty.key("ctrl+shift+"+keys[i],function(t,e){return function(){var n=JSON.stringify({event:"patternLab.keyPress",keyPress:"ctrl+shift+"+t});return parent.postMessage(n,e),!1}}(keys[i],targetOrigin));for(var i=0;10>i;)jwerty.key("ctrl+shift+"+i,function(t,e){return function(){var n=("file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,JSON.stringify({event:"patternLab.keyPress",keyPress:"ctrl+shift+"+t}));return parent.postMessage(n,e),!1}}(i,targetOrigin)),i++}var body=document.getElementsByTagName("body");body[0].onclick=function(){var t="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,e=JSON.stringify({event:"patternLab.bodyClick",bodyclick:"bodyclick"});parent.postMessage(e,t)},window.addEventListener("message",receiveIframeMessage,!1);var annotationsPattern={commentsOverlayActive:!1,commentsOverlay:!1,commentsEmbeddedActive:!1,commentsEmbedded:!1,commentsGathered:{event:"patternLab.annotationPanel",commentOverlay:"on",comments:[]},trackedElements:[],targetOrigin:"file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,gatherComments:function(){if(null===document.getElementById("sg-patterns")){var t=0;for(var e in comments.comments){var n=comments.comments[e],a=document.querySelectorAll(n.el);if(a.length>0){t++,n.displaynumber=t;for(var o=0;o<a.length;++o)a[o].onclick=function(t){return function(e){if(annotationsPattern.commentsOverlayActive){e.preventDefault(),e.stopPropagation();var n=JSON.stringify({event:"patternLab.annotationNumberClicked",displaynumber:t.displaynumber,el:t.el,title:t.title,comment:t.comment});parent.postMessage(n,annotationsPattern.targetOrigin)}}}(n)}}}else{var r=JSON.stringify({event:"patternLab.annotationPanel",commentOverlay:"off"});parent.postMessage(r,annotationsPattern.targetOrigin)}},embedComments:function(t,e,n){var a=document.createElement("div");a.classList.add("sg-annotation");var o=document.createElement("h3"),r=document.createElement("p");o.innerHTML=e,r.innerHTML=n,a.appendChild(o),a.appendChild(r);var i=annotationsPattern.findParent(t),s=i.getElementsByClassName("sg-annotations");if(s.length>0)s[0].appendChild(a);else{var l=document.createElement("div");l.classList.add("sg-annotations"),l.appendChild(a),i.appendChild(l)}},findParent:function(t){var e;return t.classList.contains("sg-pattern")?t:t.parentNode.classList.contains("sg-pattern")?t.parentNode:e=annotationsPattern.findParent(t.parentNode)},receiveIframeMessage:function(t){if("file:"==window.location.protocol||t.origin===window.location.protocol+"//"+window.location.host){var e,n,a,o,r,i="string"!=typeof t.data?t.data:JSON.parse(t.data);if(void 0!==i.event&&"patternLab.resize"==i.event&&annotationsPattern.commentsOverlayActive)for(e=0;e<annotationsPattern.trackedElements.length;++e){var s=annotationsPattern.trackedElements[e];"0px"==window.getComputedStyle(s.element,null).getPropertyValue("max-height")?(s.element.firstChild.style.display="none",n=JSON.stringify({event:"patternLab.annotationUpdateState",annotationState:!1,displayNumber:s.displayNumber}),parent.postMessage(n,annotationsPattern.targetOrigin)):(s.element.firstChild.style.display="block",n=JSON.stringify({event:"patternLab.annotationUpdateState",annotationState:!0,displayNumber:s.displayNumber}),parent.postMessage(n,annotationsPattern.targetOrigin))}else if(void 0!==i.event&&"patternLab.annotationPanel"==i.event){if(annotationsPattern.commentsOverlayActive=!1,annotationsPattern.commentsEmbeddedActive=!1,"on"===i.commentToggle&&null!==document.getElementById("sg-patterns")?annotationsPattern.commentsEmbeddedActive=!0:"on"===i.commentToggle&&(annotationsPattern.commentsOverlayActive=!0),!annotationsPattern.commentsOverlayActive){for(o=document.querySelectorAll(".has-annotation"),e=0;e<o.length;e++)o[e].classList.remove("has-annotation");for(o=document.querySelectorAll(".annotation-tip"),e=0;e<o.length;e++)o[e].style.display="none"}if(!annotationsPattern.commentsEmbeddedActive)for(o=document.getElementsByClassName("sg-annotations"),e=0;e<o.length;e++)o[e].style.display="none";if(annotationsPattern.commentsOverlayActive){var l=0;for(e=0;e<comments.comments.length;e++)if(r=comments.comments[e],o=document.querySelectorAll(r.el),a=!0,o.length)for(l++,k=0;k<o.length;k++){o[k].classList.add("has-annotation");var c=document.createElement("span");c.innerHTML=l,c.classList.add("annotation-tip"),"0px"==window.getComputedStyle(o[k],null).getPropertyValue("max-height")&&(c.style.display="none",a=!1),annotationsPattern.trackedElements.push({itemel:r.el,element:o[k],displayNumber:l,state:a}),o[k].insertBefore(c,o[k].firstChild)}for(l=0,e=0;e<comments.comments.length;e++)if(a=!0,r=comments.comments[e],o=document.querySelectorAll(r.el),o.length>0){for(l++,k=0;k<o.length;k++)"0px"==window.getComputedStyle(o[k],null).getPropertyValue("max-height")&&(a=!1);var d={el:r.el,title:r.title,comment:r.comment,number:l,state:a};annotationsPattern.commentsGathered.comments.push(d)}n=JSON.stringify(annotationsPattern.commentsGathered),parent.postMessage(n,annotationsPattern.targetOrigin)}else if(annotationsPattern.commentsEmbeddedActive&&!annotationsPattern.commentsEmbedded)for(e=0;e<comments.comments.length;e++)r=comments.comments[e],o=document.querySelectorAll(r.el),o.length>0&&annotationsPattern.embedComments(o[0],r.title,r.comment),annotationsPattern.commentsEmbedded=!0;else if(annotationsPattern.commentsEmbeddedActive&&annotationsPattern.commentsEmbedded)for(o=document.getElementsByClassName("sg-annotations"),e=0;e<o.length;++e)o[e].style.display="block"}}}};annotationsPattern.gatherComments(),window.addEventListener("message",annotationsPattern.receiveIframeMessage,!1),window.onbeforeunload=function(){var t=JSON.stringify({event:"patternLab.annotationPanel",commentOverlay:"off"});parent.postMessage(t,annotationsPattern.targetOrigin)},jwerty.key("ctrl+shift+a",function(){var t=JSON.stringify({event:"patternLab.keyPress",keyPress:"ctrl+shift+a"});return parent.postMessage(t,codePattern.targetOrigin),!1}),jwerty.key("esc",function(){var t=JSON.stringify({event:"patternLab.keyPress",keyPress:"esc"});return parent.postMessage(t,codePattern.targetOrigin),!1});var codePattern={codeOverlayActive:!1,codeEmbeddedActive:!1,targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,receiveIframeMessage:function(t){if("file:"==window.location.protocol||t.origin===window.location.protocol+"//"+window.location.host){var e="string"!=typeof t.data?t.data:JSON.parse(t.data);if(void 0!==e.event&&"patternLab.codePanel"==e.event){var n,a;if(codePattern.codeOverlayActive=!1,codePattern.codeEmbeddedActive=!1,"on"==e.codeToggle&&null!==document.getElementById("sg-patterns")?codePattern.codeEmbeddedActive=!0:"on"==e.codeToggle&&(codePattern.codeOverlayActive=!0),!codePattern.codeEmbeddedActive&&null!==document.getElementById("sg-patterns"))for(n=document.getElementsByClassName("sg-code"),a=0;a<n.length;a++)n[a].style.display="none";if(codePattern.codeOverlayActive){var o=JSON.stringify({event:"patternLab.codePanel",codeOverlay:"on",patternData:patternData});parent.postMessage(o,codePattern.targetOrigin)}else if(codePattern.codeEmbeddedActive)for(n=document.getElementsByClassName("sg-code"),a=0;a<n.length;++a)n[a].style.display="block"}}}};window.addEventListener("message",codePattern.receiveIframeMessage,!1),window.onbeforeunload=function(){var t=JSON.stringify({event:"patternLab.codePanel",codeOverlay:"off"});parent.postMessage(t,codePattern.targetOrigin)},jwerty.key("ctrl+shift+c",function(){var t=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"ctrl+shift+c"});return parent.postMessage(t,codePattern.targetOrigin),!1}),jwerty.key("cmd+a/ctrl+a",function(){if(codePattern.codeOverlayActive){var t=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"cmd+a"});return parent.postMessage(t,codePattern.targetOrigin),!1}}),jwerty.key("ctrl+shift+u",function(){var t=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"ctrl+shift+u"});return parent.postMessage(t,codePattern.targetOrigin),!1}),jwerty.key("ctrl+shift+h",function(){var t=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"ctrl+shift+h"});return parent.postMessage(t,codePattern.targetOrigin),!1}),jwerty.key("esc",function(){var t=JSON.stringify({event:"patternLab.codeKeyPress",keyPress:"esc"});return parent.postMessage(t,codePattern.targetOrigin),!1});